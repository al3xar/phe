lay pre
lay prev
lay off
lay tui
tui lay
lay regs
q
b main
r
find "/bin/bash"
b vulnerable
c
ni
ni
ni
ni
ni
ni
ni
ni
ni
x/10wx $esp
r
r
c
lay asm
b 0x80491a8
ni
q
b main
r
find "/bin/bash"
p $esp
p $ebp
q
clear
p $esp
b main
r
p $esp
x/s 0xfffff2a0
x/s 0xffffd2a0
p $ebp
x/s 0xffffd212
x/s 0xffffcbdc
x/s 0xffffd20c
x/s 0xffffd214
p $ebp 
find "/bin/bash"
p $esp 
q
b main
r
clear
find "/bin/bash"
exit
b main
r
find "/bin/bash"
find "SHELL=/bin/bash"
x/20s 0xffffd1bf
p $esp
p $ebp
find "/bin/bash"
q
b main
r
find "/bin/bash"
q
b main
r
find "/bin/bash"
p $esp
p $esb
p $ebp
q
b main
r
p &buffer
b vulnerable
c
p &buffer
find "/bin/bash"
q
b vulnerable
r
print &buffer
find "/bin/bash"
info frame
p $ebp
p $esp
q
b vulnerable
r < "AAAAAAAAAAAAAAAAAAAAAA"
exit
r
b main
r
find "/bin/bash"
b main
r
find "/bin/bash"
b vulnerable
r < payload
n
ni
x/20wx $esp
ni
x/20wx $esp
ni
x/20wx $esp
find "/bin/bash"
p $esp
p &buffer
b main
r
fin "/bin/bash"
find "/bin/bash"
p $esp

p &buffer
b vulnerable
c
p &buffer
x/10wx $esp
find "/bin/bash"
print &buffer
p $esp
ci
ni
ni
ni
ni
ni
ni
ni
ni
ni
x/20wx $esp
ni
exit
b main
r
find "/bin/bash"
p $esp
x/10wx $esp
p $esp
x/10wx $esp
p &buffer
b vulnerable
c
p &buffer
x/10wx $esp
find "/bin/bash"
q
b vulnerable
r
q
b vulnerable
r < payload
ni
x/20wx $esp
find "/bin/bash"
p $esp
q
b vulnerable
r < payload
ni
x/20wx $esp
find "/bin/bash"
q
b vulnerable
r < payload
ni
x/10wx $esp
find "/bin/bash"
p $esp
q
b vulnerable
r < payload
ni
x/20wx $esp
find "/bin/bash"
q
b vulnerable
r < payload
p $ebp
find "/bin/bash"
env
q
b vulnerable
r < payload
p $ebp
find "/bin/bash"
q
exec env
command env
help
info proc mappings
b main 
r
info proc mappings
p envp[0]
info proc mappings
info proc mappings
exit
exit
info frame
x/s *((char **)environ)
x/20wx $esp
q
b main
b vulnerable
info frame
disas
q
info stack
find "/bin/bash"
print $ebp
print $esp
q
find "/bin/bash"
b main
r
find "/bin/bash"
p $esp
q
b main
p $esp
r
p $esp
p $ebp
find "/bin/bash"
q
b main
r
vmmap
q
b main
r
print $esp
print &esp
info frame
info stack
find "/bin/bash"
print &buffer
b vulnerable
c
print &buffer
find /bin/bash
q+
q
b main
r
p exit
q
